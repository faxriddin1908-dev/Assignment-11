def print_document(users_db, printer_config, user_id, printer_type, pages):

    if user_id not in users_db:
        raise KeyError("User unknown")

    if printer_type not in printer_config:
        raise KeyError("Invalid printer type")

    if type(pages) != int or pages < 1:
        raise ValueError("Page count must be positive integer")

    price = printer_config[printer_type]["cost"]
    total_cost = pages * price

    if users_db[user_id]["role"] == "Staff":
        total_cost = 0.0

    if users_db[user_id]["quota"] < total_cost:
        raise ValueError("Insufficient quota")

    users_db[user_id]["quota"] = users_db[user_id]["quota"] - total_cost

    return float(total_cost)


def process_print_queue(users_db, printer_config, job_list):

    total_credits_burned = 0.0
    failed_jobs = 0

    for job in job_list:
        user_id, printer_type, pages = job

        try:
            cost = print_document(
                users_db,
                printer_config,
                user_id,
                printer_type,
                pages
            )
            total_credits_burned += cost

        except Exception as err:
            print(f"Print Error for {user_id}: {err}")
            failed_jobs += 1

    return {
        "total_credits_burned": total_credits_burned,
        "failed_jobs": failed_jobs
    }
